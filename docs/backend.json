{
  "entities": {
    "Chamado": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Chamado",
      "type": "object",
      "description": "Represents a IT support ticket ('chamado') within the Plant√£oAI system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Chamado entity."
        },
        "tipoDemanda": {
          "type": "string",
          "description": "The type of demand, either 'interface estruturada' or 'texto livre'."
        },
        "dadosBrutos": {
          "type": "string",
          "description": "The raw input data provided by the user, either structured or free text."
        },
        "titulo": {
          "type": "string",
          "description": "The standardized title generated by the Gemini API."
        },
        "descricaoTecnica": {
          "type": "string",
          "description": "The standardized technical description generated by the Gemini API."
        },
        "resolucao": {
          "type": "string",
          "description": "The standardized resolution generated by the Gemini API."
        },
        "dataCriacao": {
          "type": "string",
          "description": "The date and time when the Chamado was created.",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "description": "The current status of the Chamado (e.g., 'open', 'in progress', 'resolved')."
        }
      },
      "required": [
        "id",
        "tipoDemanda",
        "dadosBrutos",
        "titulo",
        "descricaoTecnica",
        "resolucao",
        "dataCriacao",
        "status"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}/chamados/{chamadoId}",
        "definition": {
          "entityName": "Chamado",
          "schema": {
            "$ref": "#/backend/entities/Chamado"
          },
          "description": "Stores IT support tickets (Chamados) created by a specific user. The 'userId' parameter identifies the user who created the Chamado.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "chamadoId",
              "description": "The unique identifier of the Chamado."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to store and manage IT support tickets (Chamados) created via structured forms or free text. The structure focuses on simplicity and security, leveraging path-based ownership and denormalization for authorization independence. All Chamados are stored under a user's document, ensuring only authenticated users can access their own data. This design avoids complex authorization logic within the security rules.\n\n**Authorization Independence and QAPs:** Authorization Independence is achieved by storing each Chamado document directly under the user's document (`/users/{userId}/chamados/{chamadoId}`). This eliminates the need for `get()` calls in the security rules to check the parent document's data. QAPs (Rules Are Not Filters) are supported because listing operations are scoped to the user's own data, preventing unauthorized access to other users' Chamados.\n\n**Structural Segregation:** All documents within the `/users/{userId}/chamados/{chamadoId}` collection share the same security posture, where only the authenticated user (`request.auth.uid == userId`) can read, write, update or delete. There is no need to mix data with different access needs within the same collection."
  }
}